[toc]

# 建议

## 综合

* 避免未定义和依赖环境的行为
  * 未定义的行为, 源于编译器无须或不能检测的错误.
      * 这样的代码有可能会通过编译, 甚至于在某些情况下有可能正确执行. 但无法保证在其	他情况下能正常工作.
  * 程序应该尽量避免依赖于实现环境的行为
      * 如, 将`int`的大小视为一个确定的已知值, 这将使得程序不可移植(**nonportable**); 因为, 不同的实现中, `int`的大小是不同的, 所以, 程序在不同的实现环境中可能发现错误.
* 简洁有时是美德; Brevity can be a virtue.
* 善于使用编辑器和开发环境的辅助工具
## 变量

### 类型

* 如何选择类型
  * 当你知道数值不为负时，使用无符号类型
  * 整数运算时，使用`int`类型；当数值大于`int`的保证最小值时，使用`long long`类型
      * 原因：`short`一般来说太小，而`long`的大小通常跟`int`的大小一样。
  * 不要在算术表达式中使用`char`或`bool`。
  * 浮点数运算时，使用`double`类型；
      * 原因：`float`经常精度不够，而且双精度和单精度的计算代价相差无几；`long double`提供的精度在一般情况下是没有必要的，而且运行的消耗不容忽视。
* 关于数组
  * 不要将非常量表达式用于数组的尺寸
### 定义
* 初始化每一个内置类型的变量;
* 当你第一次使用变量时再定义它;

## 表达式与运算符

* 拿不准的时候最好用括号来强制让表达式的组合关系符合程序逻辑的需求
* 在表达式中会改变某个运算对象的值, 那么不要在表达式的其他地方使用该运算对象了. 如:`iter+(++iter)`
  * 改变对象的子表达式可以当作其他表达式的操作数; 如`*++iter`
* 在必要时才使用递增递减运算符的后置版本

## 语句

* 使用空语句时应该加上注释, 以表明该语句是有意省略的.
* 在`switch`语句中, 安全起见, 最好在最后一个标签后面写上`break`语句
* 在`switch`语句中, 没有写`break`语句时, 最好加上注释, 因为很少出现省略`break`语句的情况
* 在`switch`语句中, 最好定义一个`default`标签, 即便没有需要它的地方. 其目的是让程序的读者知道, 已经考虑到了默认情况.

## 函数

* 函数最好是在头文件中声明, 在源文件中定义; 含有函数声明的头文件应该被包含到定义函数的源文件中.
* 如果可能, 使用常量引用; 使用指向非`const`的引用会极大地限制了函数所能接受的实参类型
* 当几个函数的操作非常相似时才进行函数重载
* 调用重载函数时应尽量避免强制类型转换; 如果在实际应用中需要强制类型转换, 则说明形参集合设计得不合理

## 类

* 如果不能使用类内初始符, 每个构造函数最好为内置类型的成员显式初始化
* 构造函数不应该覆写类内初始符, 除非要使用不同的初始符
* 友元声明最好集中在类定义开始或结尾的位置
* 通常把类定义和友元对象的声明放在同一头文件中
* 把共有代码放入私有功能函数中; 原因
  * 重用代码
  * 随着类的规模发展, 公共代码会越发复杂; 把公共代码写在同一处的作用也越明显
  * 方便调试
  * 对于一些规模较小的公共代码来说, 可以指明为`inline`, 所以没有额外的开销
* 尽量使用构造函数初始符列表
* 最好令构造函数初始符列表的顺序与成员声明的顺序保持一致
* 尽量避免使用某些成员初始化其他成员
* 如果可能的话, 最好提供一个默认构造函数
* 常量静态数据成员最好在类的外部定义, 即使在类内部被初始化(即提供了类内初始符)

## 头文件

* 头文件应该设置保护符, 即使它没有被包含在任何其他头文件中. 头文件保护符很容易设置, 而且只要合理设置, 不会影响到你的程序.

* 使用C++版本的C标准库库头文件
  * C++标准库兼容了C语言的标准库, 则两种头文件的内容是一样的. C语言的头文件形如`name.h`, 而C++将文件命名为`cname`, 也就是去掉`.h`后缀并在文件名前添加字母`c`.
  * C++版本的头文件中定义的名字从属于命名空间`std`, 而原始版本的头文件不属于. 所以使用`cname`形式的头文件时, 标准库的名字总能在`std`命名空间中找到; 而使用`name.h`形式的头文件时, 程序员不得不时刻记得哪些从C语言中继承的, 哪些又是C++独有的.

## C++标准库

### 如何选择顺序容器类型

* 除非有使用其他容器的原因, 一般使用`vector`
* 如果有很多小元素, 而且空间开销很重要, 不要使用`list`或`forward_list`
* 需要随机访问元素, 使用`vector`或`deque`
* 需要在容器的中间位置插入或删除元素, 使用`list`或`forward_list`
* 需要在容器的头尾位置插入或删除元素, 使用`deque`
* 如果只在读取输入时向容器的中间位置插入元素, 然后需要随机访问元素
    * 在输入时使用`list`; 输入完成后, 从`list`拷贝到`vector`

# 警告

* 不能在`范围for`的循环体内改变其所遍历序列的大小